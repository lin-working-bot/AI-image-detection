<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI图片真假识别</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap');
    /* 未来感字体 Orbitron */

    /* 背景渐变+动态数字雨效果 */
    body {
      margin: 0;
      padding: 0;
      height: 100vh;
      font-family: 'Orbitron', sans-serif;
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      overflow: hidden;
      color: #a0f0ff;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* 浮动数字雨 */
    #matrix {
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      pointer-events: none;
      z-index: 0;
      user-select: none;
    }

    /* 容器 */
    .container {
      position: relative;
      background: rgba(10, 25, 40, 0.9);
      padding: 40px 50px;
      border-radius: 20px;
      box-shadow:
        0 0 15px #00f0ff88,
        0 0 40px #00f0ff44 inset;
      max-width: 420px;
      width: 100%;
      text-align: center;
      z-index: 1;
    }

    h2 {
      font-size: 2rem;
      margin-bottom: 30px;
      letter-spacing: 4px;
      text-transform: uppercase;
      color: #00f0ff;
      text-shadow: 0 0 10px #00f0ffaa;
    }

    input[type="file"] {
      width: 100%;
      padding: 40px 20px;
      border: 2px dashed #00f0ffaa;
      border-radius: 16px;
      background: transparent;
      color: #00f0ff;
      font-weight: 600;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.3s ease, border-color 0.3s ease;
      user-select: none;
    }
    input[type="file"]:hover {
      background-color: #00f0ff22;
      border-color: #00f0ffee;
      color: #00aaff;
    }

    button {
      margin-top: 25px;
      width: 100%;
      padding: 15px 0;
      background: linear-gradient(90deg, #00f0ff, #0077ff);
      border: none;
      border-radius: 16px;
      font-weight: 700;
      font-size: 18px;
      color: #001122;
      letter-spacing: 1.2px;
      cursor: pointer;
      box-shadow: 0 0 12px #00f0ffcc;
      transition: box-shadow 0.3s ease, transform 0.2s ease;
    }
    button:hover {
      box-shadow: 0 0 20px #00f0ffff;
      transform: scale(1.05);
    }

    #result {
      margin-top: 35px;
      padding: 20px;
      background: #001122cc;
      border-radius: 16px;
      font-weight: 700;
      font-size: 18px;
      color: #00e6ff;
      min-height: 70px;
      box-shadow: inset 0 0 10px #00f0ffaa;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <canvas id="matrix"></canvas>
  <div class="container">
    <h2>AI图片真假识别</h2>
    <form id="uploadForm" enctype="multipart/form-data">
      <input type="file" name="file" accept="image/*" required />
      <button type="submit">提交</button>
    </form>
    <div id="result"></div>
  </div>

  <script>
    // Matrix 数字雨动画
    const canvas = document.getElementById('matrix');
    const ctx = canvas.getContext('2d');
    let width, height;
    const letters = '01'; // 二进制数字更有科技感
    let fontSize = 16;
    let columns;

    function resize() {
      width = window.innerWidth;
      height = window.innerHeight;
      canvas.width = width;
      canvas.height = height;
      columns = Math.floor(width / fontSize);
    }
    window.addEventListener('resize', resize);
    resize();

    let drops = Array(columns).fill(1);

    function draw() {
      ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
      ctx.fillRect(0, 0, width, height);
      ctx.fillStyle = '#00f0ff';
      ctx.font = fontSize + 'px monospace';

      for(let i = 0; i < columns; i++) {
        const text = letters.charAt(Math.floor(Math.random() * letters.length));
        ctx.fillText(text, i * fontSize, drops[i] * fontSize);
        if(drops[i] * fontSize > height && Math.random() > 0.975) {
          drops[i] = 0;
        }
        drops[i]+=0.1;
      }
      requestAnimationFrame(draw);
    }
    draw();

    // 表单逻辑保持不变
    const form = document.getElementById('uploadForm');
    const resultDiv = document.getElementById('result');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(form);
      resultDiv.textContent = '预测中，请稍候...';

      try {
        const response = await fetch('/predict', {
          method: 'POST',
          body: formData
        });
        const data = await response.json();

        if (data.error) {
          resultDiv.textContent = "错误: " + data.error;
        } else {
          resultDiv.textContent =
            `预测结果: ${data.predicted_class}\n` +
            `概率 - AI: ${(data.probabilities.AI * 100).toFixed(2)}%\n` +
            `概率 - Real: ${(data.probabilities.Real * 100).toFixed(2)}%`;
        }
      } catch (err) {
        resultDiv.textContent = "请求失败，请检查网络或稍后重试。";
      }
    });
  </script>
</body>
</html>
